Vagrant.configure('2') do |config|
  config.vm.box = 'ubuntu/focal64'
  config.vm.provision 'shell', path: 'scripts/1-config.learn.ubuntu.sh'
  config.vm.provision 'shell', path: 'https://get.docker.com'
  config.vm.provision 'shell', path: 'scripts/3-config.docker.after.install.sh'

  # define manager(s)
  (1..3).each do |num|
    config.vm.define "m#{num}" do |manager|
      manager.vm.hostname = "m#{num}"
      manager.vm.network 'private_network', ip: "192.168.30.13#{num}"
      manager_resources(manager)
    end
  end

  # define worker(s)
  (1..3).each do |num|
    config.vm.define "w#{num}" do |worker|
      worker.vm.hostname = "w#{num}"
      worker.vm.network 'private_network', ip: "192.168.30.14#{num}"
      worker_resources(worker)
    end
  end
end

# adjust hadware requirements to your environment and needs
def worker_resources(worker)
  worker.vm.provider 'virtualbox' do |vb|
    vb.cpus = 1
    vb.memory = '2048'
  end
end
def manager_resources(manager)
  manager.vm.provider 'virtualbox' do |vb|
    vb.cpus = 2
    vb.memory = '4096'
  end
end
